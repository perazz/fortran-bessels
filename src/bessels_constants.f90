!  ************************************************************************************************************
!
!                                    ____  ________________ ________   _____
!                                   / __ )/ ____/ ___/ ___// ____/ /  / ___/
!                                  / __  / __/  \__ \\__ \/ __/ / /   \__ \
!                                 / /_/ / /___ ___/ /__/ / /___/ /______/ /
!                                /_____/_____//____/____/_____/_____/____/
!
!                                         Constants and parameters
!
!  MIT License
!
!  Copyright (c) 2022 Federico Perini
!  Copyright (c) 2021-2022 Michael Helton, Oscar Smith, and the Bessels.jl contributors
!
!  ************************************************************************************************************
module bessels_constants
    use iso_fortran_env
    use ieee_arithmetic, only: ieee_quiet_nan,ieee_value,ieee_negative_inf
    implicit none
    public

    integer, parameter :: BK    = real64
    integer, parameter :: BSIZE = int32

    real(BK), parameter :: ZERO     = 0.00_BK
    real(BK), parameter :: ONE      = 1.00_BK
    real(BK), parameter :: TWO      = 2.00_BK
    real(BK), parameter :: THREE    = 3.00_BK
    real(BK), parameter :: FOUR     = 4.00_BK
    real(BK), parameter :: FIVE     = 5.00_BK
    real(BK), parameter :: SIX      = 6.00_BK
    real(BK), parameter :: HALF     = 0.50_BK
    real(BK), parameter :: FOURTH   = 0.25_BK
    real(BK), parameter :: TWOTHD   = 2.0_BK/3.0_BK
    real(BK), parameter :: THIRD    = 1.0_BK/3.0_BK
    real(BK), parameter :: SIXTH    = 1.0_BK/6.0_BK


    real(BK), parameter :: PI       = acos(-1.0_BK)
    real(BK), parameter :: ONEOSQPI = ONE/SQRT(PI)
    real(BK), parameter :: TWOOPI   = TWO/PI
    real(BK), parameter :: PIO2     = PI*HALF
    real(BK), parameter :: PIO4     = PI*FOURTH
    real(BK), parameter :: SQPIO2   = 1.253314137315500251207882642405522626503493370304969158314961788171146827303924_BK
    real(BK), parameter :: SQ1O2PI  = 0.3989422804014326779399460599343818684758586311649346576659258296706579258993008_BK
    real(BK), parameter :: SQ2OPI   = 0.7978845608028653558798921198687637369517172623298693153318516593413158517986017_BK
    real(BK), parameter :: SQ2O2    = 0.707106781186547524400844362104849039284835937688474036588339868995366239231051_BK

    real(BK), parameter :: THPIO4   = 2.35619449019234492885_BK
    real(BK), parameter :: SQ2PI    = 2.5066282746310007_BK

    complex(BK), parameter :: IM    = (ZERO,ONE) ! The imaginary unit


    real(BK), parameter :: GAMMA_TWO_THIRDS  = gamma(TWOTHD)
    real(BK), parameter :: GAMMA_ONE_THIRD   = gamma(THIRD)
    real(BK), parameter :: GAMMA_ONE_SIXTH   = gamma(SIXTH)
    real(BK), parameter :: GAMMA_FIVE_SIXTHS = gamma(5.0_BK*SIXTH)

    real(BK), parameter :: J0_ROOTS(2,16) = reshape([   2.4048255576957730_BK, -1.1766916515308940e-16_BK, &
                                                        3.8317059702075125_BK, -1.5269184090088067e-16_BK, &
                                                        5.5200781102863110_BK, +8.0885971461467220e-17_BK, &
                                                        7.0155866698156190_BK, -9.4141656534103890e-17_BK, &
                                                        8.6537279129110130_BK, -2.9281260732077900e-16_BK, &
                                                        10.173468135062722_BK, +4.4821622747688880e-16_BK, &
                                                        11.791534439014281_BK, +2.8129569127787350e-16_BK, &
                                                        13.323691936314223_BK, +2.6004080647188130e-16_BK, &
                                                        14.930917708487787_BK, -7.0705145059830740e-16_BK, &
                                                        16.470630050877634_BK, -1.6190195447981280e-15_BK, &
                                                        18.071063967910924_BK, -9.6580480894262090e-16_BK, &
                                                        19.615858510468243_BK, -1.0044456345266160e-15_BK, &
                                                        21.211636629879260_BK, +4.9470774287840680e-16_BK, &
                                                        22.760084380592772_BK, -4.9257493736149220e-16_BK, &
                                                        24.352471530749302_BK, +9.1690671339510660e-16_BK, &
                                                        25.903672087618382_BK, +4.8945307264198250e-16_BK], [2,16])

    real(BK), parameter :: J1_ROOTS(2,16) = reshape([   1.8411837813406593_BK, +4.7898393919093694e-18_BK, &
                                                        3.8317059702075125_BK, -1.5269184090088067e-16_BK, &
                                                        5.3314427735250325_BK, +1.5109105349471405e-16_BK, &
                                                        7.0155866698156190_BK, -9.4141656534103890e-17_BK, &
                                                        8.5363163663462860_BK, -1.5433871213307537e-16_BK, &
                                                        10.173468135062722_BK, +4.4821622747688880e-16_BK, &
                                                        11.706004902592063_BK, +7.1213669422982460e-16_BK, &
                                                        13.323691936314223_BK, +2.6004080647188130e-16_BK, &
                                                        14.863588633909034_BK, -6.2657889887818790e-16_BK, &
                                                        16.470630050877634_BK, -1.6190195447981280e-15_BK, &
                                                        18.015527862681804_BK, -1.1196999448424267e-16_BK, &
                                                        19.615858510468243_BK, -1.0044456345266160e-15_BK, &
                                                        21.164369859188790_BK, +1.7024131380423588e-15_BK, &
                                                        22.760084380592772_BK, -4.9257493736149220e-16_BK, &
                                                        24.311326857210776_BK, -2.6147985585371720e-16_BK, &
                                                        25.903672087618382_BK, +4.8945307264198250e-16_BK], [2,16])

    real(BK), parameter :: J0_POLY_PIO2(*) =    [ +1.00000000000000000000_BK &
                                                , -0.25000000000000000000_BK &
                                                , +0.01562499999999994000_BK &
                                                , -0.00043402777777725544_BK &
                                                , +6.781684026082576000000e-6_BK &
                                                , -6.781683757550061e-8_BK &
                                                , 4.709479394601058e-10_BK &
                                                , -2.4016837144506874e-12_BK &
                                                , 9.104258208703104e-15_BK &
                                                ]

    real(BK), parameter :: J1_POLY_PIO2(*) =    [ 0.5_BK &
                                                , -0.0624999999999989_BK &
                                                , 0.002604166666657291_BK &
                                                , -5.42534721917933e-5_BK &
                                                , 6.781683542660179e-7_BK &
                                                , -5.651361336587487e-9_BK &
                                                , 3.36191211106159e-11_BK &
                                                , -1.4511302591871352e-13_BK &
                                                ]

    real(BK), parameter :: J0_POLYS(14,16) = reshape([ &
           0.0000000000000000000_BK, -0.5191474972894669_BK,     0.10793870175491979_BK,   &
           0.05660177443794914_BK,   -0.008657669593292222_BK,  -0.0021942003590739974_BK, &
           0.0002643770365942964_BK,  4.37291931443113e-5_BK,   -4.338825419759815e-6_BK,  &
          -5.304927679598406e-7_BK,   4.469819175606667e-8_BK,   4.3284827345621115e-9_BK, &
          -3.135111000732148e-10_BK, -2.628876489517534e-11_BK,  &
          -0.402759395702553_BK,      2.476919088072758e-16_BK,  0.20137969785127532_BK,   &
          -0.017518715285670765_BK,  -0.013352611033152278_BK,   0.0010359438492839443_BK, &
           0.00037218755624680334_BK,-2.4952042421113972e-5_BK, -5.776086353844158e-6_BK,  &
           3.374317129436161e-7_BK,   5.727482259215452e-8_BK,  -2.9561880489355444e-9_BK, &
          -3.905845672635605e-10_BK,  1.971332566705736e-11_BK,  &
           0.000000000000000000_BK,   0.34026480655836816_BK,   -0.030820651425593214_BK, &
          -0.05298855286760721_BK,    0.004631042145890388_BK,   0.002257440229081131_BK, &
          -0.00017518572879518415_BK,-4.6521091062878115e-5_BK,  3.199785909661533e-6_BK, &
           5.716500268232186e-7_BK,  -3.5112898510841466e-8_BK, -4.684643389757727e-9_BK, &
           2.562685034682206e-10_BK,  2.7958958795750104e-11_BK, &
           0.30011575252613254_BK,   -1.6640272822046001e-16_BK,-0.15005787626306408_BK,   &
           0.007129737603121546_BK,   0.011742619737383848_BK,  -0.0006260583453094324_BK, &
          -0.00035093119008693753_BK, 1.7929701912295164e-5_BK,  5.6239324892485754e-6_BK, &
           -2.668437501970219e-7_BK, -5.6648488273749086e-8_BK,  2.48117399780498e-9_BK,   &
           3.8876537586241154e-10_BK,-1.6657136713437192e-11_BK, &
           0.000000000000000000_BK,  -0.27145229992838193_BK,    0.015684124960953488_BK,  &
           0.044033774963413_BK,     -0.0025093022271948434_BK, -0.0020603351551475315_BK, &
           0.00011243486771159352_BK, 4.482303558813413e-5_BK,  -2.288390108003442e-6_BK,  &
          -5.679383588459768e-7_BK,   2.693939234375692e-8_BK,   4.737285529934781e-9_BK,  &
          -2.0612709555352797e-10_BK,-2.8163166483726606e-11_BK, &
          -0.2497048770578432_BK,     1.1807897766765572e-16_BK, 0.12485243852891914_BK,    &
          -0.0040907858517059345_BK, -0.010102792347641438_BK,   0.00038536375952213334_BK, &
           0.00031859711440332953_BK,-1.2373899600646271e-5_BK, -5.3013932979548665e-6_BK,  &
           2.001098153528186e-7_BK,   5.4711629662471434e-8_BK, -1.9724572531751518e-9_BK,  &
          -3.8121398193699247e-10_BK, 1.3667679743782715e-11_BK, &
           0.000000000000000000_BK,   0.23245983136472478_BK,   -0.009857064513825458_BK,   &
          -0.03818600911162367_BK,    0.0016073972920762946_BK,  0.0018420433388794816_BK,  &
          -7.581358465623415e-5_BK,  -4.159284549011371e-5_BK,   1.650645590334915e-6_BK,   &
           5.425453494592871e-7_BK,  -2.0556207467977526e-8_BK, -4.620018928884712e-9_BK,   &
           1.642028058414746e-10_BK,  2.7701605444102412e-11_BK, &
           0.21835940724787295_BK,   -8.89726402965429e-17_BK,  -0.10917970362393398_BK,    &
           0.0027314677279632535_BK,  0.008944552393700088_BK,  -0.00026391472261453583_BK, &
          -0.00028847875053074687_BK, 8.858193371737123e-6_BK,   4.9233776180403375e-6_BK,  &
          -1.5077786827161215e-7_BK, -5.190218733666561e-8_BK,   1.5539413886301204e-9_BK,  &
           3.674809363354973e-10_BK, -1.1113645791216594e-11_BK, &
           0.00000000000000000_BK,   -0.20654643307799603_BK,    0.006916736034268416_BK,   &
           0.034115572697347704_BK,  -0.001137276252948717_BK,  -0.0016680057255530109_BK,  &
           5.4841792064182565e-5_BK,  3.837965853474541e-5_BK,  -1.2335804050962046e-6_BK,  &
          -5.106259295634553e-7_BK,   1.592333632709497e-8_BK,   4.423517565793139e-9_BK,   &
          -1.3138837384184105e-10_BK,-2.6809397212536384e-11_BK, &
          -0.19646537146865717_BK,    6.979167865106427e-17_BK,  0.09823268573432613_BK,    &
          -0.001988037402152532_BK,  -0.008095530671166083_BK,   0.00019440675128712672_BK, &
           0.0002640383898036336_BK, -6.666777683303928e-6_BK,  -4.5715696772304925e-6_BK,  &
           1.1666296153560847e-7_BK,  4.8913639696764225e-8_BK, -1.2379867207945651e-9_BK,  &
          -3.508930968415813e-10_BK,  9.07632091591013e-12_BK,   &
           0.00000000000000000_BK,    0.18772880304043943_BK,   -0.005194182350684612_BK,   &
          -0.031096513233785917_BK,   0.0008577442641273341_BK,  0.0015312251534677639_BK,  &
          -4.184307585284775e-5_BK,  -3.5603170534217916e-5_BK,  9.58002109234601e-7_BK,    &
           4.795250964600283e-7_BK,  -1.263434500625308e-8_BK,  -4.20550167685701e-9_BK,    &
           1.065791122326672e-10_BK,  2.5727417675684577e-11_BK, &
           0.18006337534431555_BK,   -5.638484737644332e-17_BK, -0.09003168767215539_BK,    &
           0.0015299132863046024_BK,  0.0074441453680234426_BK, -0.00015060569680378768_BK, &
          -0.0002443398416353605_BK,  5.227001519013193e-6_BK,   4.267152607972633e-6_BK,   &
          -9.295966007495808e-8_BK,  -4.610438011417262e-8_BK,   1.0049092632275165e-9_BK,  &
           3.339442682325105e-10_BK, -7.4991079301099e-12_BK,    &
           0.00000000000000000_BK,   -0.17326589422922986_BK,    0.004084217951979124_BK,   &
           0.028749284970146657_BK,  -0.0006761643016121907_BK, -0.0014215899173758441_BK,  &
           3.320978125391802e-5_BK,   3.3264379323815026e-5_BK, -7.684444100376941e-7_BK,   &
          -4.515479818833484e-7_BK,   1.0271599456634145e-8_BK,  3.993903280527723e-9_BK,   &
          -8.793975528824604e-11_BK, -2.4610374225652004e-11_BK, &
          -0.16718460047381803_BK,    4.662597138876655e-17_BK,  0.08359230023690671_BK,    &
          -0.0012242529339116864_BK, -0.006925682915280748_BK,   0.00012100729852042988_BK, &
           0.00022821854128498174_BK,-4.230799709959437e-6_BK,  -4.007618360337058e-6_BK,   &
           7.601217108010105e-8_BK,   4.358483157250522e-8_BK,  -8.317621452517008e-10_BK,  &
          -3.178805429572483e-10_BK,  6.284538399593043e-12_BK,  &
           0.000000000000000000_BK,   0.16170155068925002_BK,   -0.0033200234006036146_BK,  &
          -0.02685937038656159_BK,    0.0005505380905909195_BK,  0.0013316994659124243_BK,  &
          -2.715683205388875e-5_BK,  -3.1289544794362e-5_BK,     6.326900360777323e-7_BK,   &
           4.2697141781883964e-7_BK, -8.532447325590315e-9_BK,  -3.799009445641295e-9_BK,   &
           7.379552811590934e-11_BK,  2.353654960834717e-11_BK,  &
           0.15672498625285222_BK,    1.1464880342445208e-19_BK,-0.07836249312642612_BK,    &
           0.0010083833270351796_BK,  0.006501011610557426_BK,  -9.993664895655577e-5_BK,   &
          -0.00021478298462967253_BK, 3.511086890959515e-6_BK,   3.7857022791122945e-6_BK,  &
          -6.350944888510364e-8_BK,  -4.135588012575766e-8_BK,   7.135988717747828e-10_BK,  &
           3.2075281131621564e-10_BK, 2.208506585533542e-12_BK], [14,16])

    real(BK), parameter :: J1_POLYS(14,16) = reshape([ &
           0.5818652242815964_BK,     8.973834293036876e-17_BK, -0.20511071214777496_BK,    &
           0.006058948324597746_BK,   0.013801769808047723_BK,  -0.0003723170971916689_BK,  &
          -0.0003949590750416506_BK,  9.202953658715798e-6_BK,   6.267292697927347e-6_BK,   &
          -1.2681571675674473e-7_BK, -6.319326736018798e-8_BK,   1.057852721352679e-9_BK,   &
           4.839653511789343e-10_BK, -2.1534683937074676e-11_BK, &
           0.0000000000000000000_BK, -0.402759395702553_BK,      0.05255614585697725_BK,    &
           0.053410444132722765_BK,  -0.005179719245639115_BK,  -0.00223312533910116_BK,    &
           0.00017466429071755533_BK, 4.6208700909637e-5_BK,    -3.0368632747366735e-6_BK,  &
          -5.727790851165856e-7_BK,   3.248220586398651e-8_BK,   4.732693354840469e-9_BK,   &
          -2.346792988667587e-10_BK, -2.607612190048509e-11_BK,  &
          -0.34612620185379156_BK,    2.6002760076991505e-17_BK, 0.16697453550109428_BK,    &
          -0.009678268542879972_BK,  -0.012099225779175138_BK,   0.0006654009006841076_BK,  &
           0.0003541389011182841_BK, -1.742720356958137e-5_BK,  -5.655294960447268e-6_BK,   &
           2.484316221112215e-7_BK,   5.7101369594782676e-8_BK, -2.2587104440771904e-9_BK,  &
          -3.9854619701676605e-10_BK, 1.854508641982197e-11_BK,  &
           0.00000000000000000000_BK, 0.30011575252613254_BK,   -0.02138921280934146_BK,    &
          -0.04697047894974007_BK,    0.0031302917260424344_BK,  0.0021055871432169443_BK,  &
          -0.00012550790947431806_BK,-4.499147505171648e-5_BK,   2.401580334889493e-6_BK,   &
           5.665260872870135e-7_BK,  -2.7272058756924113e-8_BK, -4.718921752439826e-9_BK,   &
           2.045523137027535e-10_BK,  2.6923755198436e-11_BK,    &
           0.27329994163319987_BK,   -1.3511933704624036e-16_BK,-0.13477468037992396_BK,    &
           0.005116340346495344_BK,   0.010631861751990702_BK,  -0.000448743683849691_BK,   &
          -0.0003268000185531749_BK,  1.3382556752353113e-5_BK,  5.363177082527157e-6_BK,   &
          -2.0647461181851255e-7_BK, -5.499892476485602e-8_BK,   1.9780335410646812e-9_BK,  &
           3.8456897851545063e-10_BK,-1.5543946040865833e-11_BK, &
           0.0000000000000000000_BK, -0.2497048770578432_BK,     0.012272357555101388_BK,   &
           0.04041116939079181_BK,   -0.0019268187972545589_BK, -0.0019115826893618788_BK,  &
           8.661729445925766e-5_BK,   4.241116264477775e-5_BK,  -1.800978985430059e-6_BK,   &
          -5.47159694982648e-7_BK,    2.1682608288127194e-8_BK,  4.629875997238198e-9_BK,   &
          -1.6946465290961774e-10_BK,-2.7001263147077087e-11_BK, &
          -0.23330441717143408_BK,    1.3347222236161232e-16_BK, 0.11580092244607755_BK,    &
          -0.0032489977328297747_BK, -0.009372527206041913_BK,   0.0003036138212749204_BK,  &
           0.00029804555521007126_BK,-9.813819271763006e-6_BK,  -5.0242293237237345e-6_BK,  &
           1.6136482548346424e-7_BK,  5.251755806094281e-8_BK,  -1.6213723779041528e-9_BK,  &
          -3.7130918416720704e-10_BK, 1.2840797195120732e-11_BK, &
           0.00000000000000000000_BK, 0.21835940724787295_BK,   -0.008194403183877394_BK,   &
          -0.03577820957502993_BK,    0.001319573612804675_BK,   0.0017308725061602815_BK,  &
          -6.200735153951766e-5_BK,  -3.938703730297954e-5_BK,   1.3569938030086903e-6_BK,  &
           5.190652330962483e-7_BK,  -1.7082573736581586e-8_BK, -4.464580500726025e-9_BK,   &
           1.3835552663370753e-10_BK, 2.6508049073606443e-11_BK, &
           0.20701265272531905_BK,   -1.1572365385200866e-16_BK,-0.10303781563402706_BK,    &
           0.002289729546293356_BK,   0.008432435058846974_BK,  -0.00021965941971569214_BK, &
          -0.000272721543802475_BK,   7.36909520166486e-6_BK,    4.682127415369e-6_BK,      &
          -1.2611406291992532e-7_BK, -4.9733737497256667e-8_BK,  1.313333637862963e-9_BK,   &
           3.5584811981981077e-10_BK,-1.0581432980865016e-11_BK, &
           0.00000000000000000000_BK,-0.19646537146865717_BK,    0.005964112206447895_BK,   &
           0.032382122684890324_BK,  -0.0009720337562254532_BK, -0.0015842303417456071_BK,  &
           4.6667442166602986e-5_BK,  3.6572573450276185e-5_BK, -1.0499611641790313e-6_BK,  &
          -4.891787571238003e-7_BK,   1.3609422867092438e-8_BK,  4.2640592578446675e-9_BK,  &
          -1.1321195999108497e-10_BK,-2.5685037344174917e-11_BK, &
          -0.18801748852581776_BK,    9.806595982257605e-17_BK,  0.09371909377243136_BK,    &
          -0.0017233243363111925_BK, -0.007714266760106843_BK,   0.00016755862384546863_BK, &
           0.000251827174474777_BK,  -5.7335177376628445e-6_BK, -4.372425030172481e-6_BK,   &
           1.0045839852031556e-7_BK,  4.698184959516747e-8_BK,  -1.0717704296017814e-9_BK,  &
          -3.3952344362582674e-10_BK, 8.773851724781324e-12_BK,  &
           0.00000000000000000000_BK, 0.18006337534431555_BK,   -0.004589739858905968_BK,   &
          -0.029776581472313136_BK,   0.0007530284838491313_BK,  0.0014660390526475475_BK,  &
          -3.658900932751018e-5_BK,  -3.4137236390211275e-5_BK,  8.366325091910564e-7_BK,   &
           4.6108475352995054e-7_BK, -1.1047200388967438e-8_BK, -4.058793425595929e-9_BK,   &
           9.363513647344476e-11_BK,  2.4720051360744732e-11_BK, &
           0.1734590492857464_BK,    -8.319859584484218e-17_BK, -0.08653590193876039_BK,    &
           0.0013568189856187354_BK,  0.007147216520714834_BK,  -0.00013295776598760658_BK, &
          -0.00023462959289705953_BK, 4.6031437800947915e-6_BK,  4.103196271673978e-6_BK,   &
          -8.18373301294018e-8_BK,   -4.44403211204062e-8_BK,    8.872617322304839e-10_BK,  &
           3.2359730989751983e-10_BK,-7.354373969368619e-12_BK,  &
           0.00000000000000000000_BK,-0.16718460047381806_BK,    0.0036727588017285762_BK,  &
           0.02770273166133465_BK,   -0.0006050364924617241_BK, -0.0013693112504440895_BK,  &
           2.9615596890234806e-5_BK,  3.206096184277923e-5_BK,  -6.841058767433935e-7_BK,   &
          -4.358877331737043e-7_BK,   9.143763763164119e-9_BK,   3.864037532317281e-9_BK,   &
          -7.851667555762691e-11_BK, -2.3728757802646805e-11_BK, &
          -0.1618382095526585_BK,     7.115722920799028e-17_BK,  0.08078219522574913_BK,    &
          -0.0011038527651152986_BK, -0.006686444726790514_BK,   0.00010870535083026479_BK, &
           0.00022030197347228358_BK,-3.791805814546456e-6_BK,  -3.871147931227952e-6_BK,   &
           6.80607764766372e-8_BK,    4.2160129307780366e-8_BK, -7.460427055677985e-10_BK,  &
          -3.0872139357605097e-10_BK, 6.24158293622982e-12_BK,   &
           0.00000000000000000000_BK, 0.15672498625285222_BK,   -0.0030251499811055965_BK,  &
          -0.026004046442225856_BK,   0.0004996832448037306_BK,  0.001288697907658241_BK,   &
          -2.457760943647847e-5_BK,  -3.02856199504406e-5_BK,    5.715983781675481e-7_BK,   &
           4.136275513873783e-7_BK,  -7.703846567878601e-9_BK,  -3.6853569596797437e-9_BK,  &
           6.676439988396374e-11_BK,  2.277101500922319e-11_BK], [14,16])

    real(BK), parameter :: bessely_cheb_weights(29,17) = reshape([ &
         -0.030017698430846347_BK, 0.04841599615543705_BK, -0.06170112748210926_BK, 0.010992867154582408_BK, & ! 1
         -0.03732304718455494_BK, -0.06704282983696781_BK, 0.05527054188949959_BK, 0.023931299324571078_BK,  &
         -0.01660982874247215_BK, -0.0038257184915278875_BK, 0.0024486563159734553_BK, 0.00036760669126412974_BK,&
         -0.00022289024621774598_BK, -2.400043085835714e-5_BK, 1.3967165370379739e-5_BK, 1.1481395619070928e-6_BK, &
         -6.449732666954525e-7_BK, -4.1980803435719734e-8_BK, 2.2894937763100794e-8_BK, 1.228873366161081e-9_BK, &
         -6.497632451926297e-10_BK, -2.8492149116234243e-11_BK, 1.4818408405099196e-11_BK, 6.100556567848311e-13_BK, &
         -2.9867774919978274e-13_BK, -6.185528280054444e-15_BK, 3.7311423791866865e-15_BK, 4.123685520036296e-16_BK, &
         -1.3481279584734043e-16_BK, &
          0.04160742192322324_BK, 0.034668235600932615_BK, 0.11174468340078995_BK, -0.04099618095057443_BK, & ! 2
          0.1254503646682523_BK, -0.13898784797365799_BK, -0.09733131946545694_BK, 0.07149834579877713_BK, &
          0.023375835755720973_BK, -0.014572641168112577_BK, -0.002981779009597293_BK, 0.0016841968136507765_BK,&
          0.0002422436246301404_BK, -0.000127737004832643_BK, -1.3814377122225202e-5_BK, 6.9111332786206e-6_BK,&
          5.866764647818481e-7_BK, -2.8135569182003675e-7_BK, -1.9403344167501224e-8_BK, 8.972400084810467e-9_BK, &
          5.113342130666102e-10_BK, -2.2951010536509386e-10_BK, -1.1304711135449809e-11_BK, 4.905817815473565e-12_BK, &
          1.894873147278986e-13_BK, -8.217632923341561e-14_BK, -4.218847493575595e-15_BK, 1.6772297836301473e-15_BK, &
         -7.137148015447435e-17_BK, &
          0.022713476918759194_BK, -0.03501714644493984_BK, 0.04900399934159489_BK, -0.004572920361822816_BK,& ! 3
          0.03414506477673644_BK, 0.0583364038403724_BK, -0.04624123224424829_BK, -0.02357706101501925_BK, &
          0.01424650161095809_BK, 0.004131847507694573_BK, -0.0021768978247202514_BK, -0.0004222406947531938_BK, &
          0.00020419469487529897_BK, 2.882041410641021e-5_BK, -1.3118879606205788e-5_BK, -1.419547866831786e-6_BK,&
          6.171197932015276e-7_BK, 5.3215526542899864e-8_BK, -2.2283397359466684e-8_BK, -1.5689346295358737e-9_BK, &
          6.370162334131838e-10_BK, 3.785641839686755e-11_BK, -1.4927226121841386e-11_BK, -7.280852508197353e-13_BK,&
          2.822365357297534e-13_BK, 1.4096858601066386e-14_BK, -5.194257722353411e-15_BK, -1.784287003861859e-17_BK, &
          1.784287003861859e-17_BK, &
         -0.005482743163667869_BK, -0.0026156864489958096_BK, -0.013446106107341984_BK, 0.003959772572751581_BK, & ! 4
         -0.013050739904566335_BK, 0.012785648905104951_BK, 0.012302789524159771_BK, -0.007125881422379595_BK, &
         -0.0032178006311644504_BK, 0.0015436443743600617_BK, 0.0004291283948110706_BK, -0.00018601906106350898_BK,&
         -3.5730026469563336e-5_BK, 1.4521000123576475e-5_BK, 2.0641877773886624e-6_BK, -8.0134383976041e-7_BK, &
         -8.833134689166324e-8_BK, 3.3105750509021536e-8_BK, 2.9248427531622776e-9_BK, -1.0652720751644758e-9_BK,&
         -7.761774457286969e-11_BK, 2.758318276166857e-11_BK, 1.6716350526024826e-12_BK, -5.818832518996889e-13_BK, &
         -3.163144349623995e-14_BK, 1.0744381574921492e-14_BK, 3.598312124454748e-16_BK, -1.2688263138573217e-16_BK, &
         -1.4373423086664974e-17_BK, &
         -0.000821102524680051_BK, 0.001369166415512963_BK, -0.0017176445978307614_BK, -0.00038167202153855176_BK, & ! 5
         -0.0010693704116036165_BK, -0.0034162564467415902_BK, 0.0019105668931819009_BK, 0.0015608651654028757_BK, &
         -0.000662690872417737_BK, -0.00028896692147194577_BK, 0.00010910809251752316_BK, 3.0258725355010946e-5_BK, &
         -1.0717669999955374e-5_BK, -2.0862028639579696e-6_BK, 7.091627814767861e-7_BK, 1.0306000805131983e-7_BK, &
         -3.4017752731151496e-8_BK, -3.856023535105163e-9_BK, 1.2437339960318393e-9_BK, 1.1358064900927889e-10_BK, &
         -3.594555586962962e-11_BK, -2.7016821319796643e-12_BK, 8.405911755350802e-13_BK, 5.4115690103654197e-14_BK, &
         -1.660105584745862e-14_BK, -8.187894806610529e-16_BK, 2.462687791788503e-16_BK, 2.0816681711721685e-17_BK, &
         -6.443258625056712e-18_BK, &
          0.0002240588217758784_BK, -2.139628782819116e-5_BK, 0.0004963922147532327_BK, -0.00011956525731319659_BK, & ! 6
          0.00038470659301256783_BK, -0.00022845214105494214_BK, -0.0004692565509103452_BK, 0.0001676797752522885_BK, &
          0.0001335452722506947_BK, -4.206397012022229e-5_BK, -1.847619067631446e-5_BK, 5.51981330361833e-6_BK, &
          1.5583457267047952e-6_BK, -4.525989246540121e-7_BK, -9.035200300660385e-8_BK, 2.5768522858261958e-8_BK, &
          3.852458639733455e-9_BK, -1.084135171755376e-9_BK, -1.2724325563785672e-10_BK, 3.5416192958546876e-11_BK, &
          3.3285729083723912e-12_BK, -9.174161771285542e-13_BK, -7.329222174604474e-14_BK, 2.0034423068009816e-14_BK, &
          1.2002737593513098e-15_BK, -3.2511254198458856e-16_BK, -2.7507757976203656e-17_BK, 6.753030674338285e-18_BK, &
         -4.336808689942018e-19_BK, &
          4.6589086507212064e-6_BK, -1.419986317236695e-5_BK, 7.726102539451062e-6_BK, 2.5019808838475857e-5_BK, & ! 7
         -5.353457546572625e-7_BK, 7.876549687169565e-5_BK, -1.996847202131808e-5_BK, -4.169957016198162e-5_BK, &
          9.924101147153856e-6_BK, 8.2415996393497e-6_BK, -1.9586527669761305e-6_BK, -8.849155270353938e-7_BK, &
          2.1145772481562803e-7_BK, 6.146714709097454e-8_BK, -1.4757833806872662e-8_BK, -3.0347995540046756e-9_BK, &
          7.310991241996968e-10_BK, 1.1291045426976899e-10_BK, -2.724231275323183e-11_BK, -3.306873481836321e-12_BK, &
          7.984081946667783e-13_BK, 7.777996686699921e-14_BK, -1.874952442498305e-14_BK, -1.5555232495803793e-15_BK, &
          3.750913580232083e-16_BK, 2.4244503044553087e-17_BK, -6.63977026881971e-18_BK, -8.441288342922856e-19_BK, &
          3.7947076036992655e-19_BK, &
         -3.837876843131191e-6_BK, 1.5306249581045373e-6_BK, -7.808225833446716e-6_BK, 8.447928863780004e-7_BK,& ! 8
         -4.570697567070479e-6_BK, -4.1982552639485557e-7_BK, 8.226238919809268e-6_BK, -9.86994172463081e-7_BK, &
         -2.6319604894434756e-6_BK, 4.2742958932228587e-7_BK, 3.841104494715522e-7_BK, -7.011130365317191e-8_BK, &
         -3.295984466784781e-8_BK, 6.37554898520718e-9_BK, 1.9212842748116095e-9_BK, -3.851870296260733e-10_BK, &
         -8.157917257527438e-11_BK, 1.6727904537992146e-11_BK, 2.682049173124509e-12_BK, -5.589600448593574e-13_BK, &
         -6.949400331178381e-14_BK, 1.4635958089930247e-14_BK, 1.5059865847402264e-15_BK, -3.216721361622551e-16_BK, &
         -2.5000540452330927e-17_BK, 5.001971562950145e-18_BK, -1.961002277600456e-18_BK, 9.647251501576167e-19_BK, &
         -6.969871108835386e-19_BK, &
          1.576952254652365e-7_BK, -9.540862698044819e-8_BK, 3.3917615684812697e-7_BK, -4.813870672453743e-7_BK, & ! 9
          2.6408257938646016e-7_BK, -8.568425702351827e-7_BK, -1.2996848292204935e-7_BK, 5.684699761362054e-7_BK, &
         -2.7544597243559516e-8_BK, -1.247732596836196e-7_BK, 1.4090830850669181e-8_BK, 1.398591135642683e-8_BK, &
         -1.991545843477106e-9_BK, -9.83479157367889e-10_BK, 1.5579619154787597e-10_BK, 4.8812239436949277e-11_BK, &
         -8.259978073280919e-12_BK, -1.7977167324163993e-12_BK, 3.156743262349288e-13_BK, 5.3090323232950275e-14_BK, &
         -9.680314873025469e-15_BK, -1.183751262421577e-15_BK, 2.1703251434347915e-16_BK, 2.5924059718442872e-17_BK, &
         -5.649951767599685e-18_BK, 8.287120783728401e-19_BK, -1.0219906276273448e-18_BK, 2.5227968798668708e-18_BK,&
         -1.4714172340874703e-18_BK, &
          2.8189276354316185e-8_BK, -8.524800253702236e-9_BK, 5.163074759458915e-8_BK, 1.7587774571193398e-8_BK, & ! 10
          1.5532689836449176e-8_BK, 4.569379005731088e-8_BK, -7.364565287663236e-8_BK, -1.3794427678087878e-8_BK, &
          2.8705869772299055e-8_BK, -2.180238319299374e-10_BK, -4.6124233142017096e-9_BK, 3.6839126250828555e-10_BK, &
          4.0853238049027397e-10_BK, -4.58540375117209e-11_BK, -2.4105895138400274e-11_BK, 3.1690572156845862e-12_BK, &
          1.025021315725097e-12_BK, -1.4748687505667043e-13_BK, -3.336472532024983e-14_BK, 5.062095043025821e-15_BK, &
          8.815484952439681e-16_BK, -1.390034081631452e-16_BK, -1.9199758208465145e-17_BK, 2.8599694051079214e-18_BK, &
          4.412739143428028e-19_BK, -1.4432387356775567e-18_BK, -2.3578466668818103e-18_BK, -8.403587813975867e-19_BK, &
         -2.0135183203302226e-19_BK, &
         -2.7963515253359716e-9_BK, 2.6599405451754447e-9_BK, -5.363225685883765e-9_BK, 3.919112883175106e-9_BK, & ! 11
         -2.6445728931356353e-9_BK, 3.986389181091895e-9_BK, 4.369788563535614e-9_BK, -4.202468942903132e-9_BK, &
         -8.620553821731379e-10_BK, 1.1190715605385904e-9_BK, 1.6458619897562414e-11_BK, -1.364556955782257e-10_BK,&
          7.770660894600997e-12_BK, 9.797565423719047e-12_BK, -8.709272762295716e-13_BK, -4.951317701122077e-13_BK, &
          5.5017193500686674e-14_BK, 1.7973668773098524e-14_BK, -2.186053134804191e-15_BK, -5.417976610912264e-16_BK, &
          7.265668497060572e-17_BK, 1.0657145676262853e-17_BK, -1.4951583811856726e-18_BK, 1.001165055851074e-19_BK, &
         -4.215593642978497e-19_BK, -8.996650316071422e-19_BK, 1.1892060156355519e-18_BK, -5.459522028374813e-19_BK, &
         -9.29316147844718e-19_BK, &
         -2.869285397772589e-11_BK, -1.425452662669203e-10_BK, -1.4765859863811186e-11_BK, -3.584266980792905e-10_BK, & ! 12
          1.2630165211284162e-10_BK, -4.813898813698495e-10_BK, 2.9823341363420924e-10_BK, 2.736833504070133e-10_BK, &
         -1.789940159530945e-10_BK, -3.709803166716433e-11_BK, 3.4844491459805023e-11_BK, 8.72681373200755e-13_BK, &
         -3.2915591662608672e-12_BK, 1.3002232883748757e-13_BK, 1.9753949839973547e-13_BK, -1.4075604115824882e-14_BK, &
         -8.601511614454014e-15_BK, 8.194975088384275e-16_BK, 2.6866096515073e-16_BK, -2.6539953077529138e-17_BK, &
         -6.38116169641218e-18_BK, -1.8536358293679684e-18_BK, 4.749772369976817e-19_BK, -6.718043393812506e-19_BK, &
          1.608438964002761e-19_BK, 5.165497356149306e-20_BK, 2.605394963005647e-19_BK, 1.0581028516295723e-19_BK, &
          3.601100072898283e-19_BK, &
          1.7263987678277334e-11_BK, -1.3813366927208365e-11_BK, 2.934247457063122e-11_BK, -7.979165795689896e-12_BK, & ! 13
          4.195660738851445e-12_BK, 3.4756966192072763e-12_BK, -3.8868044414248185e-11_BK, 1.4360156231687025e-11_BK, &
          1.2343845937660092e-11_BK, -6.048594850472885e-12_BK, -1.1764419064241353e-12_BK, 8.840620586141411e-13_BK, &
          2.5310500957954275e-14_BK, -6.57823088425572e-14_BK, 1.5812120648028614e-15_BK, 3.437403053731452e-15_BK, &
         -2.0773399722137888e-16_BK, -1.2502298901942747e-16_BK, 1.1188335458126739e-17_BK, 1.318770475529763e-18_BK, &
          1.826317128659254e-18_BK, -1.371135591032674e-18_BK, -7.556266590585322e-19_BK, -1.3319774595248458e-19_BK, &
         -6.907940207156658e-20_BK, 1.774511101624311e-18_BK, -4.537139020388408e-20_BK, 4.949220345202049e-19_BK, &
         -1.1868141638100254e-18_BK, &
         -8.498193197325338e-13_BK, 1.953201750327066e-12_BK, -1.6836406424518253e-12_BK, 2.5267159459094905e-12_BK, & ! 14
         -1.1786713409725903e-12_BK, 2.057320315641163e-12_BK, 2.5591575645466365e-13_BK, -2.0678475108903006e-12_BK, &
          5.290174964157149e-13_BK, 4.2270269001999225e-13_BK, -1.680245826111033e-13_BK, -2.838265511092047e-14_BK, &
          1.8427577852297096e-14_BK, 5.755842428415847e-16_BK, -1.1124766162836294e-15_BK, 1.08483878138819e-17_BK, &
          5.233365672134661e-17_BK, -4.1398608828316095e-18_BK, -1.5252680555707005e-18_BK, 1.5518391236648752e-21_BK, &
         -1.914160606977295e-18_BK, -1.1560851262788287e-18_BK, 8.614032803477796e-19_BK, -2.4613082189127555e-18_BK, &
          2.3715585034500812e-18_BK, -7.375149035246488e-19_BK, 1.5108762141152207e-18_BK, -1.5506658311469656e-18_BK, &
          8.17023779980148e-19_BK, &
         -2.5827236864549892e-14_BK, -3.4718790561504414e-14_BK, -2.2011098530056326e-14_BK, -9.110104031477491e-14_BK, & ! 15
          7.290507373316453e-14_BK, -1.234623611877002e-13_BK, 1.6275850841628636e-13_BK, 1.798444625683851e-14_BK,&
         -8.154482889879963e-14_BK, 1.634453336575052e-14_BK, 1.129456516347965e-14_BK, -3.897439775077071e-15_BK, &
         -5.305238116730616e-16_BK, 3.1481637373066765e-16_BK, 1.2762608430395386e-17_BK, -1.6640493419786607e-17_BK,&
          4.907490184278107e-19_BK, 3.285996490596493e-19_BK, -1.6693969668826682e-18_BK, -6.276996493483055e-19_BK, &
          2.2721860225308528e-18_BK, -1.0636166658032876e-18_BK, 5.4043840077706323e-20_BK, -6.733003923003965e-19_BK, &
          8.654687466171472e-19_BK, -1.6353891516146702e-18_BK, -1.1401886941945345e-18_BK, 1.806451000706121e-18_BK, &
          1.0454806663253078e-18_BK, &
          4.9388506677207545e-15_BK, -8.11264980108463e-15_BK, 8.15564695267678e-15_BK, -6.6179014247901285e-15_BK, & ! 16
          1.2560443562777774e-15_BK, -1.1626485837362674e-15_BK, -8.428647433288211e-15_BK, 8.040878625052107e-15_BK, &
          7.604076442794149e-16_BK, -2.509940602859596e-15_BK, 4.433411320740124e-16_BK, 2.4051574424535735e-16_BK, &
         -7.97263854654364e-17_BK, -8.468775456115063e-18_BK, 3.0977204928150507e-18_BK, -2.763609694292828e-18_BK, &
         -4.528057493615123e-18_BK, 8.090667992714159e-18_BK, -5.7670273029389466e-18_BK, 6.935237082901993e-18_BK, &
          2.3956539089710175e-18_BK, 3.5297683311975285e-18_BK, -2.6680862870119677e-19_BK, -1.124331067925833e-18_BK, &
         -3.969891564639305e-18_BK, 3.4988194829519685e-18_BK, 8.636411459915624e-19_BK, -1.3895984430563314e-18_BK, &
          1.7657006809049643e-18_BK, &
         -2.058125495426769e-16_BK, 6.08114692374987e-16_BK, -4.430737266654462e-16_BK, 7.070791826861885e-16_BK, & ! 17
         -4.496672312473068e-16_BK, 4.992680927678948e-16_BK, -2.0005398723221536e-16_BK, -4.085152288266179e-16_BK, &
          2.963046065367326e-16_BK, 1.9081397648228198e-17_BK, -6.065778883208153e-17_BK, 1.2267254817829564e-17_BK, &
          2.5241246780253446e-18_BK, 5.364001077188067e-19_BK, -1.1151793774136653e-18_BK, -2.647497194530543e-19_BK, &
         -9.99558548618923e-19_BK, 1.9545043306813755e-18_BK, 1.0295729550672243e-18_BK, 5.850363951633064e-19_BK, &
          2.039938658283451e-19_BK, -1.622964422184252e-18_BK, -2.1240860691038883e-18_BK, 2.0835979355758296e-18_BK, &
         -1.5423943263121515e-19_BK, -5.576729517866199e-19_BK, -3.7259501367076117e-20_BK, -1.8905808347578018e-19_BK, &
         -1.4869058365515489e-18_BK],[29,17])

    real(BK), parameter :: YP_Y0(8) = [-1.84950800436986690637E16_BK, 4.42733268572569800351E16_BK, &
                                       -3.46628303384729719441E15_BK, 8.75906394395366999549E13_BK, &
                                       -9.82136065717911466409E11_BK, 5.43526477051876500413E9_BK,  &
                                       -1.46639295903971606143E07_BK, 1.55924367855235737965E4_BK]

    real(BK), parameter :: YQ_Y0(8) = [2.50596256172653059228E17_BK, 3.17157752842975028269E15_BK, &
                                       2.02979612750105546709E13_BK, 8.64002487103935000337E10_BK, &
                                       2.68919633393814121987E08_BK, 6.26107330137134956842E05_BK, &
                                       1.04128353664259848412E03_BK, 1.00000000000000000000E00_BK]


    real(BK), parameter :: PP_Y0(7) = [9.99999999999999997821E-1_BK, 5.30324038235394892183E00_BK, &
                                       8.74716500199817011941E00_BK, 5.44725003058768775090E00_BK, &
                                       1.23953371646414299388E00_BK, 8.28352392107440799803E-2_BK, &
                                       7.96936729297347051624E-4_BK]

    real(BK), parameter :: PQ_Y0(7) = [1.00000000000000000218E00_BK, 5.30605288235394617618E00_BK, &
                                       8.76190883237069594232E00_BK, 5.47097740330417105182E00_BK, &
                                       1.25352743901058953537E00_BK, 8.56288474354474431428E-2_BK, &
                                       9.24408810558863637013E-4_BK]

    real(BK), parameter :: QP_y0(8) = [-6.05014350600728481186E00_BK, -5.14105326766599330220E01_BK, &
                                       -1.47077505154951170175E02_BK, -1.77681167980488050595E02_BK, &
                                       -9.32060152123768231369E01_BK, -1.95539544257735972385E01_BK, &
                                       -1.28252718670509318512E00_BK, -1.13663838898469149931E-2_BK]

    real(BK), parameter :: QQ_y0(8) = [2.42005740240291393179E02_BK, 2.06209331660327847417E03_BK, &
                                       5.93072701187316984827E03_BK, 7.24046774195652478189E03_BK, &
                                       3.88240183605401609683E03_BK, 8.56430025976980587198E02_BK, &
                                       6.43178256118178023184E01_BK, 1.00000000000000000000E00_BK]


    real(BK), parameter :: PP_j1(*) = [1.00000000000000000254E00_BK, 5.21451598682361504063E00_BK, &
                                       8.42404590141772420927E00_BK, 5.11207951146807644818E00_BK, &
                                       1.12719608129684925192E00_BK, 7.31397056940917570436E-2_BK, &
                                       7.62125616208173112003E-4_BK]

    real(BK), parameter :: PQ_j1(*) = [9.99999999999999997461E-1_BK, 5.20982848682361821619E00_BK, &
                                       8.39985554327604159757E00_BK, 5.07386386128601488557E00_BK, &
                                       1.10514232634061696926E00_BK, 6.88455908754495404082E-2_BK, &
                                       5.71323128072548699714E-4_BK]

    real(BK), parameter :: QP_j1(*) = [2.52070205858023719784E01_BK, 2.11688757100572135698E2_BK, &
                                       5.97489612400613639965E02_BK, 7.10856304998926107277E2_BK, &
                                       3.66779609360150777800E02_BK, 7.58238284132545283818E1_BK, &
                                       4.98213872951233449420E00_BK, 5.10862594750176621635E-2_BK]

    real(BK), parameter :: QQ_j1(*) = [3.36093607810698293419E02_BK, 2.82619278517639096600E03_BK, &
                                       7.99704160447350683650E03_BK, 9.56231892404756170795E03_BK, &
                                       4.98641058337653607651E03_BK, 1.05644886038262816351E03_BK, &
                                       7.42373277035675149943E01_BK, ONE]

    real(BK), parameter :: YP_y1(*) = [-7.78877196265950026825E17_BK, 2.02439475713594898196E17_BK, &
                                       -8.12770255501325109621E15_BK, 1.14509511541823727583E14_BK, &
                                       -6.47355876379160291031E11_BK, 1.26320474790178026440E09_BK]

    real(BK), parameter :: YQ_y1(*) = [3.97270608116560655612E18_BK, 6.87141087355300489866E16_BK, &
                                       6.20557727146953693363E14_BK, 3.88231277496238566008E12_BK, &
                                       1.87601316108706159478E10_BK, 7.34811944459721705660E07_BK, &
                                       2.35564092943068577943E05_BK, 5.94301592346128195359E02_BK, &
                                       ONE]

    real(BK), parameter :: P1_K0(*) = [-1.372509002685546267e-1_BK, 2.574916117833312855e-1_BK, &
                                        1.395474602146869316e-2_BK, 5.445476986653926759e-4_BK, &
                                        7.125159422136622118e-6_BK]

    real(BK), parameter :: Q1_K0(*) = [ 1.000000000000000000e+00_BK, -5.458333438017788530e-02_BK, &
                                        1.291052816975251298e-03_BK, -1.367653946978586591e-05_BK]

    real(BK), parameter :: Y_K0     = 1.137250900268554688_BK
    real(BK), parameter :: Y_k1     = 8.69547128677368164e-2_BK
    real(BK), parameter :: Y2_k1    = 1.45034217834472656_BK

    real(BK), parameter :: P2_K0(*) = [ 1.159315156584124484e-01_BK, 2.789828789146031732e-01_BK, &
                                        2.524892993216121934e-02_BK, 8.460350907213637784e-04_BK, &
                                        1.491471924309617534e-05_BK, 1.627106892422088488e-07_BK, &
                                        1.208266102392756055e-09_BK, 6.611686391749704310e-12_BK]
    real(BK), parameter :: P3_K0(*) = [ 2.533141373155002416e-1_BK, 3.628342133984595192e0_BK, &
                                        1.868441889406606057e1_BK, 4.306243981063412784e1_BK, &
                                        4.424116209627428189e1_BK, 1.562095339356220468e1_BK, &
                                       -1.810138978229410898e0_BK, -1.414237994269995877e0_BK, &
                                       -9.369168119754924625e-2_BK]

    real(BK), parameter :: Q3_K0(*) = [ONE, 1.494194694879908328e1_BK, 8.265296455388554217e1_BK, &
                                            2.162779506621866970e2_BK, 2.845145155184222157e2_BK, &
                                            1.851714491916334995e2_BK, 5.486540717439723515e1_BK, &
                                            6.118075837628957015e0_BK, 1.586261269326235053e-1_BK]


    real(BK), parameter :: P1_k1(*) = [-3.62137953440350228e-3_BK, 7.11842087490330300e-3_BK, &
                                        1.00302560256614306e-5_BK, 1.77231085381040811e-6_BK]

    real(BK), parameter :: Q1_k1(*) = [1.00000000000000000e0_BK, -4.80414794429043831e-2_BK, &
                                       9.85972641934416525e-4_BK, -8.91196859397070326e-6_BK]

    real(BK), parameter :: P2_k1(*) = [-3.07965757829206184e-1_BK, -7.80929703673074907e-02_BK, &
                                       -2.70619343754051620e-3_BK, -2.49549522229072008e-5_BK]

    real(BK), parameter :: Q2_k1(*) = [1.00000000000000000e0_BK, -2.36316836412163098e-2_BK, &
                                       2.64524577525962719e-4_BK, -1.49749618004162787e-6_BK]

    real(BK), parameter :: P3_k1(*) = [-1.97028041029226295e-1_BK, -2.32408961548087617e0_BK, &
                                       -7.98269784507699938e0_BK, -2.39968410774221632e0_BK, &
                                        3.28314043780858713e1_BK, 5.67713761158496058e1_BK, &
                                        3.30907788466509823e1_BK, 6.62582288933739787e0_BK, &
                                        3.08851840645286691e-1_BK]

    real(BK), parameter :: Q3_k1(*) = [1.00000000000000000e0_BK, 1.41811409298826118e1_BK, &
                                       7.35979466317556420e1_BK, 1.77821793937080859e2_BK, &
                                       2.11014501598705982e2_BK, 1.19425262951064454e2_BK, &
                                       2.88448064302447607e1_BK, 2.27912927104139732e0_BK, &
                                       2.50358186953478678e-2_BK]

    real(BK), parameter :: besseli0_small_coefs(*) = [0.9999999999999998_BK, 0.2500000000000052_BK, &
                                                      0.027777777777755364_BK, 0.001736111111149161_BK, &
                                                      6.94444444107536e-05_BK, 1.9290123635366806e-6_BK, &
                                                      3.9367592765038015e-8_BK, 6.151201574092085e-10_BK, &
                                                      7.593827956729909e-12_BK, 7.596677643342155e-14_BK, &
                                                      6.255282299620455e-16_BK, 4.470993793303175e-18_BK, &
                                                      2.1859737023077178e-20_BK, 2.0941557335286373e-22_BK]

    real(BK), parameter :: besseli0_med_coefs(*) = [0.3989422804014326_BK, 0.04986778505064754_BK, &
                                                    0.028050628512954097_BK, 0.02921968830978531_BK, &
                                                    0.04466889626137549_BK, 0.10220642174207666_BK, &
                                                    -0.9937439085650689_BK, 91.25330271974727_BK, &
                                                    -4901.408890977662_BK, 199209.2752981982_BK, &
                                                    -6.181516298413396e6_BK, 1.4830278710991925e8_BK, &
                                                    -2.7695254643719645e9_BK, 4.0351394830842026e10_BK, &
                                                    -4.5768930327229974e11_BK, 4.0134844243070063e12_BK, &
                                                    -2.6862476523182016e13_BK, 1.3437999451218112e14_BK, &
                                                    -4.856333741437621e14_BK, 1.1962791200680235e15_BK, &
                                                    -1.796269414464399e15_BK, 1.239942074380968e15_BK]


    real(BK), parameter :: besseli0_large_coefs(*) = [0.3989422804014327_BK, 0.04986778505003549_BK, &
                                                      0.028050629664438713_BK, 0.029218603406797997_BK, &
                                                      0.045199090067282434_BK]


    real(BK), parameter :: besseli1_small_coefs(*) = [ &
                            0.08333333333333334_BK, 0.006944444444444374_BK, 0.00034722222222248526_BK, &
                            1.1574074073690356e-5_BK, 2.7557319253050506e-7_BK, 4.920949730519126e-9_BK, &
                            6.834656365321179e-11_BK, 7.593985414952446e-13_BK, 6.904652315442046e-15_BK, &
                            5.2213850252454655e-17_BK, 3.405120412140281e-19_BK, 1.6398527256182257e-21_BK, &
                            1.3161876924566675e-23_BK]

    real(BK), parameter :: besseli1_med_coefs(*) = [ &
                            0.39894228040143276_BK, -0.149603355151029_BK, -0.04675104787903509_BK, &
                            -0.04090746353279043_BK, -0.05744911840910781_BK,-0.12283724006390319_BK, &
                            1.0023632527650936_BK, -94.90954045770921_BK, 5084.06899084327_BK, &
                            -206253.5613716743_BK, 6.387439538535799e6_BK, -1.529244018923123e8_BK, &
                            2.849523551208316e9_BK, -4.141884344471782e10_BK, 4.6860149658304974e11_BK, &
                            -4.097852944580042e12_BK, 2.7345051110005453e13_BK, -1.3634833112030364e14_BK, &
                            4.909983186948892e14_BK, -1.2048200837913132e15_BK, 1.8014682382937435e15_BK, &
                            -1.2377987428989558e15_BK]

    real(BK), parameter :: besseli1_large_coefs(*) = [ &
                            0.39894228040143265, -0.14960335515036183, -0.0467510491854453, &
                            -0.04090618769936314, -0.05808395099511361]

    interface besseljy_debye_cutoff
       module procedure besseljy_debye_cutoff128
       module procedure besseljy_debye_cutoff64
       module procedure besseljy_debye_cutoff32
    end interface besseljy_debye_cutoff

    interface besseljy_debye_fit
        module procedure besseljy_debye_fit128
        module procedure besseljy_debye_fit64
        module procedure besseljy_debye_fit32
    end interface besseljy_debye_fit

    ! real(BK), parameter :: besseljy_large_argument_min = 15.0f0 for real32
    ! real(BK), parameter :: besseljy_large_argument_min = 40.0f0 for real128
    real(BK), parameter :: besseljy_large_argument_min = 20.0_BK

    interface hankel_debye_cutoff
        module procedure hankel_debye_cutoff32
        module procedure hankel_debye_cutoff64
        module procedure hankel_debye_cutoff128
    end interface hankel_debye_cutoff

    interface hankel_debye_fit
        module procedure hankel_debye_fit32
        module procedure hankel_debye_fit64
    end interface hankel_debye_fit

    interface besselj_series_cutoff
        module procedure besselj_series_cutoff32
        module procedure besselj_series_cutoff64
        module procedure besselj_series_cutoff128
    end interface besselj_series_cutoff

    interface bessely_series_cutoff
        module procedure bessely_series_cutoff32
        module procedure bessely_series_cutoff64
    end interface bessely_series_cutoff


    contains

    ! Cutoffs for besseljy_debye expansions
    ! regions where the debye expansions for large orders v > x are valid
    ! determined by fitting a curve a + bx + (cx)^(1/3) to where debye expansions provide desired precision

    ! Float32
    elemental real(real32) function besseljy_debye_fit32(x)
       real(real32), intent(in) :: x
       besseljy_debye_fit32 =  2.50_real32 + 1.00035_real32*x + 7.114_real32*real(cbrt(real(x,real64)),real32)
    end function besseljy_debye_fit32

    elemental logical function besseljy_debye_cutoff32(nu, x)
       real(real32), intent(in) :: nu, x
       besseljy_debye_cutoff32 = nu > besseljy_debye_fit32(x) .and. nu > SIX
    end function besseljy_debye_cutoff32

    ! Float64
    elemental real(real64) function besseljy_debye_fit64(x)
       real(real64), intent(in) :: x
       besseljy_debye_fit64 = 2.0_real64 + 1.00035_real64*x + 6.714_real64*cbrt(x)
    end function besseljy_debye_fit64

    elemental logical function besseljy_debye_cutoff64(nu, x)
       real(real64), intent(in) :: nu, x
       besseljy_debye_cutoff64 = nu > besseljy_debye_fit64(x) .and. nu > 15.0_real64
    end function besseljy_debye_cutoff64

    ! Float128 - provide roughly ~1e-35 precision
    elemental real(real128) function besseljy_debye_fit128(x)
       real(real128), intent(in) :: x
       besseljy_debye_fit128 = 16.0_real128 + 1.0012_real128*x + cbrt(real(27.91_real128*x,real64))
    end function besseljy_debye_fit128

    elemental logical function besseljy_debye_cutoff128(nu, x)
       real(real128), intent(in) :: nu, x
       besseljy_debye_cutoff128 = nu > besseljy_debye_fit128(x) .and. nu > 40.0_real128
    end function besseljy_debye_cutoff128

    elemental logical function besseljy_large_argument_cutoff(nu, x)
       real(BK), intent(in) :: nu, x
       besseljy_large_argument_cutoff = x > 1.65_BK*nu .and. x > besseljy_large_argument_min
    end function besseljy_large_argument_cutoff

    elemental logical function hankel_debye_cutoff128(nu, x)
       real(real128), intent(in) :: nu, x
       hankel_debye_cutoff128 = nu < -2.0_real128 + 0.9987_real128*x + cbrt(-21570.3*real(x,real64))
    end function hankel_debye_cutoff128

    elemental logical function hankel_debye_cutoff64(nu, x)
       real(real64), intent(in) :: nu, x
       hankel_debye_cutoff64 = nu < hankel_debye_fit64(x)
    end function hankel_debye_cutoff64

    elemental real(real64) function hankel_debye_fit64(x)
       real(real64), intent(in) :: x
       hankel_debye_fit64 = 0.2_real64 + x + 7.435_real64*cbrt(-x)
    end function hankel_debye_fit64

    elemental logical function hankel_debye_cutoff32(nu, x)
       real(real32), intent(in) :: nu, x
       hankel_debye_cutoff32 = nu < hankel_debye_fit32(x)
    end function hankel_debye_cutoff32

    elemental real(real32) function hankel_debye_fit32(x)
       real(real32), intent(in) :: x
       hankel_debye_fit32 = -3.5 + x + 7.435*real(cbrt(-real(x,real64)))
    end function hankel_debye_fit32

    elemental logical function besselj_series_cutoff32(x,nu)
       real(real32), intent(in) :: x,nu
       besselj_series_cutoff32 = (x < 20.0_real32) .or. (nu > 14.4_real32 + x*(-0.455_real32 + 0.027_real32*x))
    end function besselj_series_cutoff32

    elemental logical function besselj_series_cutoff64(x,nu)
       real(real64), intent(in) :: x,nu
       besselj_series_cutoff64 = (x < 7.0_real32) .or. (nu > TWO + x*(0.109_real64 + 0.062_real64*x))
    end function besselj_series_cutoff64

    ! cutoff for Float128 for ~1e-35 relative error
    elemental logical function besselj_series_cutoff128(x,nu)
       real(real128), intent(in) :: x,nu
       besselj_series_cutoff128 = (x < FOUR) .or. nu > (x*(0.08_real128 + 0.12_real128*x))
    end function besselj_series_cutoff128

    elemental logical function bessely_series_cutoff32(nu,x)
       real(real32), intent(in) :: x,nu
       bessely_series_cutoff32 = (x < 21.0_real32) .or. nu > 1.38_real32*x - 12.5_real32
    end function bessely_series_cutoff32

    elemental logical function bessely_series_cutoff64(nu,x)
       real(real64), intent(in) :: x,nu
       bessely_series_cutoff64 = (x < 7.0_real64) .or. nu > 1.35_real64*x - 4.5_real64
    end function bessely_series_cutoff64

    ! Power series for J_{nu}(x)
    ! only valid in non-oscillatory regime (v>1/2, 0<t<sqrt(v^2 - 0.25))
    ! power series has premature underflow for large orders though use besseljy_debye for large orders
    elemental real(BK) function besselj_power_series(nu, x)
       real(BK), intent(in) :: nu, x

       real(real64) :: nu64,x64,out64,a,t2,xo2,rnit
       integer, parameter :: maxit = 3000
       integer :: nit
       real(real64), parameter :: ZERO64 = 0.0_real64
       real(real64), parameter ::  ONE64 = 1.0_real64
       real(real64), parameter :: HALF64 = 0.5_real64
       real(real64), parameter ::  EPS64 = epsilon(0.0_real64)

       ! Always computed in real64 precision
       nu64 = real(nu,real64)
        x64 = real(x ,real64)

        out64 = ZERO64

        xo2   = HALF64*x64

        a  = xo2**nu64 / gamma(nu64 + ONE64)
        t2 = xo2**2
        nit = 0
        do while (nit<maxit .and. .not.(abs(a)<EPS64*abs(out64)))
            nit   = nit+1
            rnit  = nit
            out64 = out64+a
            a = -a*t2/((nu64+rnit)*rnit)
        end do

        besselj_power_series = real(out64,BK)

    end function besselj_power_series

    ! Power series for Y_{nu}(x)

    ! Use power series form of J_v(x) to calculate Y_v(x) with
    ! Y_v(x) = (J_v(x)cos(v*) - J_{-v}(x)) / sin(v*pi),    v ~= 0, 1, 2, ...
    ! combined to calculate both J_v and J_{-v} in the same loop (J_{-v} always converges slower)

    ! this works well for small arguments x < 7.0 for rel. error ~1e-14
    ! this also works well for nu > 1.35x - 4.5
    ! for nu > 25 more cancellation occurs near integer values
    ! There could be premature underflow when (x/2)^v == 0.

    ! Computes ``Y_{nu}(x)`` using the power series when nu is not an integer.
    ! In general, this is most accurate for small arguments and when nu > x.
    ! Outpus both (Y_{nu}(x), J_{nu}(x)).
    pure function bessely_power_series(x, nu) result(YJ)
       real(BK), intent(in) :: x, nu
       real(BK) :: YJ(2)

       real(real64) :: nu64,x64,out64,out264,a,b,t2,xo2,rnit,spi,cpi
       integer, parameter :: maxit = 3000
       integer :: nit
       real(real64), parameter :: ZERO64 = 0.0_real64
       real(real64), parameter ::  ONE64 = 1.0_real64
       real(real64), parameter ::   PI64 = acos(-1.0_real64)
       real(real64), parameter :: HALF64 = 0.5_real64
       real(real64), parameter ::  EPS64 = epsilon(0.0_real64)

       ! Always computed in real64 precision
       nu64 = real(nu,real64)
        x64 = real(x ,real64)

       out64  = ZERO64
       out264 = ZERO64

        xo2   = HALF64*x64
        a     = xo2**nu64

        ! check for underflow and return limit for small arguments
        if (abs(a)<tiny(0.0_real64)) then

           YJ = [ieee_value(ZERO,ieee_negative_inf),real(a,BK)]

        else

           b   = ONE64/a
           a   = a/gamma( nu64 + ONE64)
           b   = b/gamma(-nu64 + ONE64)
           t2  = xo2**2
           nit = 0

           do while (nit<maxit .and. .not.(abs(b)<EPS64*abs(out264)))
               nit   = nit+1
               rnit  = nit

               out64  = out64 +a
               out264 = out264+b

               a = -a*t2/(( nu64+rnit)*rnit)
               b = -b*t2/((-nu64+rnit)*rnit)
           end do

           spi = sin(nu64*PI64)
           cpi = cos(nu64*PI64)

           YJ = real([(out64*cpi-out264)/spi,out64],BK)

        end if

    end function bessely_power_series

    ! backward recurrence relation for besselj and bessely
    ! outputs both (bessel(x, nu_end), bessel(x, nu_end-1)
    ! x = 0.1; j10 = besselj(10, x); j11 = besselj(11, x);
    ! besselj_down_recurrence(x, j10, j11, 10, 1) will give besselj(1, x)
    pure function besselj_down_recurrence(x, jnu, jnup1, nu_start, nu_end) result(jnu2)
        real(BK), intent(in) :: x,jnu,jnup1,nu_start,nu_end

        real(BK) :: x2,jnu2(2),nus

        x2   = two/x

        nus  = nu_start
        jnu2 = [jnup1,jnu]

        do while (nus>nu_end-HALF)
            jnu2 = [jnu2(2),nus*x2*jnu2(2)-jnu2(1)]
            nus = nus-ONE
        end do

    end function besselj_down_recurrence

    ! forward recurrence relation for besselj and bessely
    ! outputs both (bessel(x, nu_end), bessel(x, nu_end+1)
    ! x = 0.1; y0 = bessely0(x); y1 = bessely1(x);
    ! besselj_up_recurrence(x, y1, y0, 1, 5) will give bessely(5, x)
    elemental subroutine besselj_up_recurrence(x, jnu, jnum1, nu_start, nu_end, a, b)
        real(BK), intent(in) :: x,jnu,jnum1,nu_start,nu_end
        real(BK), intent(out) :: a,b

        real(BK) :: x2,jnu2(2),nu

        x2   = two/x
        jnu2 = [jnum1,jnu]
        nu   = nu_start

        ! avoid inexact floating points when nu is a float
        do while (nu<nu_end+HALF)
            jnu2 = [jnu2(2),nu_start*x2*jnu2(2)-jnu2(1)]
            nu = nu-ONE
        end do

        a = jnu2(1)
        b = jnu2(2)

        ! need to check if NaN resulted during loop from subtraction of infinities
        ! this could happen if x is very small and nu is large which eventually results in overflow (-> -Inf)
        ! we use this routine to generate bessely(nu::Int, x) in the forward direction starting from bessely0, bessely1
        ! NaN inputs need to be checked before getting to this routine
        if (isnan(jnu2(1))) then
            a = ieee_value(a, ieee_negative_inf)
            b = ieee_value(a, ieee_negative_inf)
        end if

    end subroutine besselj_up_recurrence

    ! cubic root function in double precision
    elemental real(BK) function cbrt(x)
       real(BK),   intent(in) :: x
       real(BK), parameter :: c(0:23) = [ 1.5319394088521e-3_BK, -1.8843445653409e-2_BK, &
                                          1.0170534986000e-1_BK, -3.1702448761286e-1_BK, &
                                          6.3520892642253e-1_BK, -8.8106985991189e-1_BK, &
                                          1.0517503764540e+0_BK,  4.2674123235580e-1_BK, &
                                          1.5079083659190e-5_BK, -3.7095709111375e-4_BK, &
                                          4.0043972242353e-3_BK, -2.4964114079723e-2_BK, &
                                          1.0003913718511e-1_BK, -2.7751961573273e-1_BK, &
                                          6.6256121926465e-1_BK,  5.3766026150315e-1_BK, &
                                          1.4842542902609e-7_BK, -7.3027601203435e-6_BK, &
                                          1.5766326109233e-4_BK, -1.9658008013138e-3_BK, &
                                          1.5755176844105e-2_BK, -8.7413201405100e-2_BK, &
                                          4.1738741349777e-1_BK,  6.7740948115980e-1_BK ]


         real(BK), parameter :: TWO_POW_3   = 8.0_BK
         real(BK), parameter :: TWO_POW_16  = 65536.0_BK
         real(BK), parameter :: TWO_POW_48  = 281474976710656.0_BK
         real(BK), parameter :: TWO_POW_M3  = ONE/TWO_POW_3
         real(BK), parameter :: TWO_POW_M16 = ONE/TWO_POW_16
         real(BK), parameter :: TWO_POW_M48 = ONE/TWO_POW_48

         integer :: k
         real(BK) :: w,y,u

         if (x==ZERO) then
            cbrt = ZERO
            return
         end if

         w = abs(x)
         y = sign(HALF,x)

         if (w > TWO_POW_3) then
             do while (w > TWO_POW_48)
                 w = w * TWO_POW_M48
                 y = y * TWO_POW_16
             end do
             do while (w > TWO_POW_3)
                 w = w * TWO_POW_M3
                 y = y * TWO
             end do
         else if (w < ONE) then
             do while (w < TWO_POW_M48)
                 w = w * TWO_POW_48
                 y = y * TWO_POW_M16
             end do
             do while (w < ONE)
                 w = w * TWO_POW_3
                 y = y * HALF
             end do
         end if

         k = merge(0,merge(8,16,w<FOUR), w<TWO)

         u = ((((((c(k)   *w + c(k+1))*w +  c(k+2))*w+ c(k+3))*w+ &
                   c(k+4))*w + c(k+5))*w +  c(k+6))*w+ c(k+7)

         cbrt = y*(u+3*u*w/(w+2*u*u*u))
    end function cbrt

    ! Evaluate polynomial sum_{i=1}^{n} (x^(k-1)*p(k)) using Horner's method
    pure function evalpoly(n,x,p) result(y)
       integer, intent(in) :: n
       real(BK), intent(in) :: x, p(n)
       real(BK) :: y
       integer :: i
       y = p(n)
       do i = n-1,1,-1
         y = p(i) + y*x
       end do
    end function evalpoly

    pure real(BK) function evalpoly8(x,p) result(y)
       real(BK), intent(in) :: x,p(8)
       y = ((((((p(8)*x+p(7))*x+p(6))*x+p(5))*x+p(4))*x+p(3))*x+p(2))*x+p(1)
    end function evalpoly8

    pure real(BK) function evalpoly7(x,p) result(y)
       real(BK), intent(in) :: x,p(7)
       y = (((((p(7)*x+p(6))*x+p(5))*x+p(4))*x+p(3))*x+p(2))*x+p(1)
    end function evalpoly7

    pure real(BK) function evalpoly5(x,p) result(y)
       real(BK), intent(in) :: x,p(5)
       y = (((p(5)*x+p(4))*x+p(3))*x+p(2))*x+p(1)
    end function evalpoly5

    pure real(BK) function evalpoly4(x,p) result(y)
       real(BK), intent(in) :: x,p(4)
       y = ((p(4)*x+p(3))*x+p(2))*x+p(1)
    end function evalpoly4

    elemental real(BK) function muladd(A,x,y) result(axpy)
       real(BK), intent(in) :: A,x,y
       axpy = A*x+y
    end function muladd

    elemental logical function isinteger(x)
       real(BK), intent(in) :: x
       isinteger = (x-nint(x))<epsilon(ZERO)
    end function isinteger

end module bessels_constants
